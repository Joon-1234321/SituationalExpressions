<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ìˆ˜ë™íƒœ ë¬¸ì¥ ë‹¨ì–´ ì¹© ë°°ì—´ í™œë™</title>
<style>
  :root{
    --bg1:#1d4ed8;
    --bg2:#0f172a;
    --card:#ffffffdd;
    --chip:#e2e8f0;
    --chip-hover:#cbd5e1;
    --accent:#2563eb;
    --accent2:#0ea5e9;
    --correct:#22c55e;
    --wrong:#ef4444;
    --text:#0f172a;
  }
  *{box-sizing:border-box;}
  body{
    margin:0;
    min-height:100vh;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding:20px;
    color:var(--text);
    font-size:1.3rem;
  }
  .wrap{
    max-width:960px;
    width:66%;
    background:var(--card);
    border-radius:18px;
    box-shadow:0 18px 45px rgba(15,23,42,.4);
    padding:18px 16px 20px;
    backdrop-filter:blur(12px);
  }
  @media (max-width:900px){
    .wrap{width:100%;}
  }

  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    margin-bottom:10px;
    flex-wrap:wrap;
  }
  .title{
    font-weight:700;
    font-size:1.2rem;
  }
  .progress{
    font-size:1rem;
    color:#475569;
    font-weight:600;
  }

  .hint{
    background:#e0f2fe;
    border-radius:12px;
    padding:12px 14px;
    margin-bottom:12px;
    font-size:1.05rem;
    font-weight:600;
  }

  .sentence-box{
    border-radius:14px;
    border:1px dashed #cbd5e1;
    background:#f8fafc;
    min-height:80px;
    padding:12px;
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    align-items:center;
    margin-bottom:14px;
  }
  .sentence-placeholder{
    font-size:1.05rem;
    color:#94a3b8;
    font-weight:500;
  }

  .chips-box{
    border-radius:14px;
    border:1px solid #e2e8f0;
    background:#eef2ff;
    min-height:90px;
    padding:12px;
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    align-items:flex-start;
  }

  .chip{
    padding:7px 14px;
    border-radius:999px;
    background:var(--chip);
    cursor:pointer;
    font-size:1.05rem;
    font-weight:700;
    transition:.15s;
    box-shadow:0 1px 4px rgba(15,23,42,.18);
    user-select:none;
  }
  .chip:hover{
    background:var(--chip-hover);
    transform:translateY(-1px);
  }

  .controls{
    margin-top:14px;
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }
  button{
    border:none;
    border-radius:999px;
    padding:8px 16px;
    font-size:0.95rem;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:4px;
    font-weight:600;
  }
  .btn-main{
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    color:white;
  }
  .btn-sub{
    background:#e2e8f0;
    color:#0f172a;
  }
  .btn-next{
    background:#22c55e;
    color:white;
  }
  .btn-next:disabled{
    opacity:0.4;
    cursor:default;
  }

  .feedback{
    margin-top:10px;
    min-height:1.3em;
    font-size:1.05rem;
    font-weight:600;
  }
  .feedback.ok{color:var(--correct);}
  .feedback.no{color:var(--wrong);}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">ìˆ˜ë™íƒœ ë¬¸ì¥ì„ ë‹¨ì–´ ì¹©ìœ¼ë¡œ ì™„ì„±í•´ ë³´ì„¸ìš”</div>
    <div class="progress"><span id="currentNum">1</span> / <span id="totalNum">0</span> ë¬¸ì¥</div>
  </header>

  <div class="hint" id="hintBox"></div>

  <div class="sentence-box" id="answerBox">
    <span class="sentence-placeholder" id="placeholder">ì•„ë˜ ë‹¨ì–´ ì¹©ì„ í´ë¦­í•´ì„œ ë¬¸ì¥ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”.</span>
  </div>

  <div class="chips-box" id="chipsBox"></div>

  <div class="controls">
    <button class="btn-main" id="checkBtn">ì •ë‹µ í™•ì¸</button>
    <button class="btn-sub" id="undoBtn">ë˜ëŒë¦¬ê¸°</button>
    <button class="btn-sub" id="clearBtn">ì§€ìš°ê¸°</button>
    <button class="btn-sub" id="shuffleBtn">ë‹¤ì‹œ ì„ê¸°</button>
    <!-- âœ… ì²˜ìŒì—ëŠ” ë¹„í™œì„±í™” -->
    <button class="btn-next" id="nextBtn" disabled>ë‹¤ìŒ ë¬¸ì¥ â–¶</button>
  </div>

  <div class="feedback" id="feedback"></div>
</div>

<script>
const items = [
  // beë™ì‚¬ í˜„ì¬ ìˆ˜ë™íƒœ 5ê°œ
  { en:"The homework is done every day.",        ko:"ìˆ™ì œëŠ” ë§¤ì¼ ëë‚œë‹¤." },
  { en:"The classroom is cleaned in the morning.", ko:"êµì‹¤ì€ ì•„ì¹¨ì— ì²­ì†Œëœë‹¤." },
  { en:"Many books are read in our class.",      ko:"ìš°ë¦¬ ë°˜ì—ì„œëŠ” ë§ì€ ì±…ì´ ì½íŒë‹¤." },
  { en:"The cookies are made by my mom.",        ko:"ì¿ í‚¤ëŠ” ìš°ë¦¬ ì—„ë§ˆê°€ ë§Œë“ ë‹¤." },
  { en:"The door is opened at 8 a.m.",           ko:"ë¬¸ì€ ì˜¤ì „ 8ì‹œì— ì—´ë¦°ë‹¤." },

  // beë™ì‚¬ ê³¼ê±° ìˆ˜ë™íƒœ 10ê°œ
  { en:"The window was broken yesterday.",       ko:"ì°½ë¬¸ì€ ì–´ì œ ê¹¨ì¡Œë‹¤." },
  { en:"The letters were sent last week.",       ko:"í¸ì§€ë“¤ì€ ì§€ë‚œì£¼ì— ë³´ë‚´ì¡Œë‹¤." },
  { en:"The game was played in the gym.",        ko:"ê·¸ ê²½ê¸°ëŠ” ì²´ìœ¡ê´€ì—ì„œ ì—´ë ¸ë‹¤." },
  { en:"The picture was painted by Mina.",       ko:"ê·¸ ê·¸ë¦¼ì€ ë¯¸ë‚˜ê°€ ê·¸ë ¸ë‹¤." },
  { en:"The bags were checked at the gate.",     ko:"ê°€ë°©ë“¤ì€ ì •ë¬¸ì—ì„œ ê²€ì‚¬ë°›ì•˜ë‹¤." },
  { en:"The test was finished early.",           ko:"ì‹œí—˜ì€ ì¼ì° ëë‚¬ë‹¤." },
  { en:"The songs were sung at the festival.",   ko:"ê·¸ ë…¸ë˜ë“¤ì€ ì¶•ì œì—ì„œ ë¶ˆë ¸ë‹¤." },
  { en:"The movie was watched at home.",         ko:"ê·¸ ì˜í™”ëŠ” ì§‘ì—ì„œ ë³´ì•˜ë‹¤." },
  { en:"The room was used by the science club.", ko:"ê·¸ ë°©ì€ ê³¼í•™ ë™ì•„ë¦¬ê°€ ì‚¬ìš©í–ˆë‹¤." },
  { en:"The puppies were found near the park.",  ko:"ê°•ì•„ì§€ë“¤ì€ ê³µì› ê·¼ì²˜ì—ì„œ ë°œê²¬ë˜ì—ˆë‹¤." },

  // ì¡°ë™ì‚¬ + ìˆ˜ë™íƒœ 10ê°œ
  { en:"The problem can be solved easily.",      ko:"ê·¸ ë¬¸ì œëŠ” ì‰½ê²Œ í•´ê²°ë  ìˆ˜ ìˆë‹¤." },
  { en:"The cakes can be eaten after lunch.",    ko:"ì¼€ì´í¬ëŠ” ì ì‹¬ ì‹ì‚¬ í›„ì— ë¨¹ì„ ìˆ˜ ìˆë‹¤." },
  { en:"The rule must be followed by everyone.", ko:"ê·¸ ê·œì¹™ì€ ëª¨ë‘ê°€ ì§€ì¼œì•¼ í•œë‹¤." },
  { en:"The door must be closed now.",           ko:"ë¬¸ì€ ì§€ê¸ˆ ë‹«í˜€ì•¼ í•œë‹¤." },
  { en:"The work will be finished soon.",        ko:"ê·¸ ì¼ì€ ê³§ ëë‚  ê²ƒì´ë‹¤." },
  { en:"The bags will be checked again.",        ko:"ê°€ë°©ë“¤ì€ ë‹¤ì‹œ ê²€ì‚¬ë  ê²ƒì´ë‹¤." },
  { en:"The project should be done this week.",  ko:"ê·¸ í”„ë¡œì íŠ¸ëŠ” ì´ë²ˆ ì£¼ì— ëë‚´ì•¼ í•œë‹¤." },
  { en:"The story should be read carefully.",    ko:"ê·¸ ì´ì•¼ê¸°ëŠ” ì£¼ì˜ ê¹Šê²Œ ì½ì–´ì•¼ í•œë‹¤." },
  { en:"The shirts may be washed tomorrow.",     ko:"ê·¸ ì…”ì¸ ë“¤ì€ ë‚´ì¼ ì„¸íƒë ì§€ë„ ëª¨ë¥¸ë‹¤." },
  { en:"The lights may be turned off at 10.",    ko:"ë¶ˆì€ 10ì‹œì— êº¼ì§ˆì§€ë„ ëª¨ë¥¸ë‹¤." }
];

const hintBox    = document.getElementById("hintBox");
const answerBox  = document.getElementById("answerBox");
const chipsBox   = document.getElementById("chipsBox");
const placeholder= document.getElementById("placeholder");
const feedback   = document.getElementById("feedback");
const currentNum = document.getElementById("currentNum");
const totalNum   = document.getElementById("totalNum");

const checkBtn   = document.getElementById("checkBtn");
const undoBtn    = document.getElementById("undoBtn");
const clearBtn   = document.getElementById("clearBtn");
const shuffleBtn = document.getElementById("shuffleBtn");
const nextBtn    = document.getElementById("nextBtn");

let idx = 0;
let historyStack = [];

totalNum.textContent = items.length;

function shuffle(arr){
  return arr.map(v=>[Math.random(),v])
            .sort((a,b)=>a[0]-b[0])
            .map(v=>v[1]);
}

function clearAnswer(){
  const chips = [...answerBox.querySelectorAll(".chip")];
  chips.forEach(c=>{
    c.remove();
    chipsBox.appendChild(c);
    c.dataset.location="pool";
  });
  placeholder.style.display="";
}

function buildSentence(i){
  const item = items[i];
  idx = i;
  currentNum.textContent = i+1;
  feedback.textContent="";
  feedback.className="feedback";
  historyStack=[];

  // ìƒˆ ë¬¸ì¥ ì‹œì‘í•  ë•ŒëŠ” í•­ìƒ ë‹¤ìŒ ë²„íŠ¼ ë¹„í™œì„±í™”
  nextBtn.disabled = true;

  hintBox.textContent = item.ko;

  const clean = item.en.replace(/[.?!]$/,"");
  const words = clean.split(" ");

  chipsBox.innerHTML="";
  answerBox.innerHTML="";
  answerBox.appendChild(placeholder);
  placeholder.style.display="";

  const shuffled = shuffle(words.slice());
  shuffled.forEach(w=>{
    const chip=document.createElement("div");
    chip.className="chip";
    chip.textContent=w;
    chip.dataset.word=w;
    chip.dataset.location="pool";
    chip.addEventListener("click", onChipClick);
    chipsBox.appendChild(chip);
  });
}

function onChipClick(e){
  const chip=e.currentTarget;
  const from=chip.dataset.location;

  saveHistory();

  if(from==="pool"){
    placeholder.style.display="none";
    answerBox.appendChild(chip);
    chip.dataset.location="answer";
  }else{
    chipsBox.appendChild(chip);
    chip.dataset.location="pool";
    if(answerBox.querySelectorAll(".chip").length===0){
      placeholder.style.display="";
    }
  }
}

function saveHistory(){
  const pool=[...chipsBox.querySelectorAll(".chip")].map(c=>c.dataset.word);
  const ans=[...answerBox.querySelectorAll(".chip")].map(c=>c.dataset.word);
  historyStack.push({pool:pool, answer:ans});
  if(historyStack.length>50) historyStack.shift();
}

function restoreHistory(){
  if(historyStack.length===0)return;
  const last=historyStack.pop();

  const all=[...chipsBox.querySelectorAll(".chip"), ...answerBox.querySelectorAll(".chip")];
  all.forEach(c=>c.remove());

  const byWord={};
  all.forEach(c=>byWord[c.dataset.word]=c);

  chipsBox.innerHTML="";
  answerBox.innerHTML="";
  answerBox.appendChild(placeholder);

  last.pool.forEach(w=>{
    const c=byWord[w];
    chipsBox.appendChild(c);
    c.dataset.location="pool";
  });
  last.answer.forEach(w=>{
    const c=byWord[w];
    answerBox.appendChild(c);
    c.dataset.location="answer";
  });

  placeholder.style.display=last.answer.length?"none":"";
}

function checkAnswer(){
  const item=items[idx];
  const clean=item.en.replace(/[.?!]$/,"");
  const target=clean.split(" ");
  const answer=[...answerBox.querySelectorAll(".chip")].map(c=>c.dataset.word);

  if(answer.length===0){
    feedback.textContent="ë¨¼ì € ë‹¨ì–´ ì¹©ì„ í´ë¦­í•´ ë¬¸ì¥ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”.";
    feedback.className="feedback no";
    nextBtn.disabled = true;
    return;
  }

  const ok = target.length===answer.length && target.every((w,i)=>w===answer[i]);

  if(ok){
    feedback.textContent="ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰";
    feedback.className="feedback ok";
    nextBtn.disabled = false;      // âœ… ì •ë‹µì¼ ë•Œë§Œ ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”
  }else{
    feedback.textContent="ì•„ì‰½ë„¤ìš”. ë‹¨ì–´ ìˆœì„œë¥¼ ë‹¤ì‹œ í™•ì¸í•´ ë³´ì„¸ìš”.";
    feedback.className="feedback no";
    nextBtn.disabled = true;       // âŒ ì˜¤ë‹µì´ë©´ ë¹„í™œì„±í™” ìœ ì§€
  }
}

checkBtn.addEventListener("click", checkAnswer);
undoBtn.addEventListener("click", restoreHistory);
clearBtn.addEventListener("click", ()=>{
  historyStack=[];
  clearAnswer();
  feedback.textContent="";
  feedback.className="feedback";
  nextBtn.disabled = true; // ì§€ìš°ë©´ ë‹¤ì‹œ ì ê¸ˆ
});
shuffleBtn.addEventListener("click", ()=>{
  buildSentence(idx);      // ë‹¤ì‹œ ì„ìœ¼ë©´ ìƒˆ ë¬¸ì œì²˜ëŸ¼
});

// âœ… ì •ë‹µ ë§í˜€ì•¼ë§Œ ì‹¤ì œë¡œ ë„˜ì–´ê°€ê²Œ
nextBtn.addEventListener("click", ()=>{
  if(nextBtn.disabled) return;  // ì ê²¨ ìˆìœ¼ë©´ ë¬´ì‹œ
  const next=(idx+1)%items.length;
  buildSentence(next);
});

buildSentence(0);
</script>
</body>
</html>
