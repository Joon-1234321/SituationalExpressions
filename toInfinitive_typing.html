<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ì˜ì‘ íƒ€ì´í•‘ - í•œ ë¬¸ì œì”© ì§„í–‰</title>
<style>
  :root{
    --primary:#1976d2; --ok:#2e7d32; --bad:#c62828; --card:#ffffff; --bg:#f0f4f8;
  }
  body{margin:0;background:var(--bg);font-family:system-ui, Arial, sans-serif;line-height:1.6;padding:20px}
  .app{max-width:900px;margin:auto;background:var(--card);border-radius:16px;box-shadow:0 6px 16px rgba(0,0,0,.08);padding:24px}
  h1{margin:0 0 12px;font-size:1.35rem}
  .progress{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .bar{height:10px;background:#e0e7ef;border-radius:999px;overflow:hidden}
  .bar>span{display:block;height:100%;background:var(--primary);width:0%}
  .dialogueBox{background:linear-gradient(135deg,#eef5ff,#f7ffef);border:1px solid #dde7f5;padding:18px;border-radius:12px;margin:14px 0;font-size:1.1rem}
  input[type="text"]{
    width:100%;padding:14px 12px;font-size:1.05rem;border:1px solid #cfd8e3;border-radius:10px;outline:none;
  }
  input[type="text"]:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(25,118,210,.12)}
  .btns{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}
  button{padding:10px 16px;border:none;border-radius:10px;cursor:pointer;font-weight:600}
  .primary{background:var(--primary);color:#fff}
  .ghost{background:#eef3f9;color:#1b3552}
  .danger{background:#fee8e7;color:#8e1a12}
  .ok{background:#e8f5e9;color:#1b5e20}
  .disabled{opacity:.55;cursor:not-allowed}
  .msg{margin-top:10px;font-weight:700}
  .msg.ok{color:var(--ok)}
  .msg.bad{color:var(--bad)}
  .answerReveal{margin-top:10px;padding:10px;border-left:4px solid var(--primary);background:#f3f8ff;border-radius:6px}
  .footer{margin-top:14px;color:#666;font-size:.95rem}
</style>
</head>
<body>
<div class="app">
  <h1>ì˜ì‘ íƒ€ì´í•‘ â€” ( ) ì•ˆì˜ í•œê¸€ì„ ì˜ì–´ë¡œ ì“°ê¸°</h1>
  <div class="progress">
    <div>ë¬¸í•­ <span id="num">1</span> / <span id="tot">9</span></div>
    <div class="bar" style="width:55%"><span id="bar"></span></div>
  </div>

  <!-- í˜„ì¬ ë¬¸í•­ë§Œ í‘œì‹œë©ë‹ˆë‹¤ -->
  <div class="dialogueBox" id="dialogue"></div>

  <input id="ans" type="text"
         placeholder="ì—¬ê¸°ì— ì˜ì–´ë¡œ ì…ë ¥í•˜ì„¸ìš” (êµ¬ë‘ì ì€ ìƒëµ ê°€ëŠ¥)"
         autocomplete="off" autocapitalize="none" autocorrect="off" spellcheck="false" inputmode="latin" />

  <div class="btns">
    <button id="checkBtn" class="primary">ì •ë‹µ í™•ì¸ (Enter)</button>
    <button id="showBtn" class="ghost disabled" disabled>ì •ë‹µ ë³´ê¸°</button>
    <button id="nextBtn" class="ok disabled" disabled>ë‹¤ìŒ â–¶</button>
    <button id="resetBtn" class="danger">ë‹¤ì‹œ í’€ê¸°</button>
  </div>

  <div id="msg" class="msg"></div>
  <div id="reveal" class="answerReveal" style="display:none"></div>

  <div class="footer">â€» êµ¬ë‘ì (<code>.,?!</code>)ì€ ìƒëµí•´ë„ ì •ë‹µ ì²˜ë¦¬ë©ë‹ˆë‹¤. ì •ë‹µì„ ì •í™•íˆ ì…ë ¥í•´ì•¼ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.</div>
</div>

<script>
/* ===== ë¬¸í•­: í™”ë©´ì—ëŠ” í•­ìƒ í˜„ì¬ ë¬¸í•­ë§Œ ë³´ì…ë‹ˆë‹¤ ===== */
const items = [
  // 1
  { context:'Jina: Minho, (ë„ˆì˜ ê¿ˆì´ ë¬´ì—‡ì´ì•¼?)', ans:'what is your dream' },
  // 2
  { context:'Minho: My dream is (ì§„ì •í•œ ì¹œêµ¬ë¥¼ ê°€ì§€ëŠ” ê²ƒ).', ans:'to have a true friend' },
  // 3
  { context:'Jina: I want a friend (í•¨ê»˜ ë†€) after school.', ans:'to play with' },
  // 4
  { context:'Minho: Everyone needs someone (ì‹ ë¢°í• ).', ans:'to trust' },
  // 5
  { context:'Jina: Yesterday, I visited Jiho (ê·¸ë¥¼ ë•ê¸°ìœ„í•´) with homework.', ans:'to help him' },
  // 6
  { context:'Minho: You are a good friend (ë‚¨ë“¤ì„ ë„ì™€ì£¼ëŠ”).', ans:'to help others' },
  // 7
  { context:'Jina: The best way (ì¹œêµ¬ê´€ê³„ë¥¼ ìœ ì§€í•˜ëŠ”) is to be kind.', ans:'to keep a friend' },
  // 8
  { context:'Jina: The best way to keep a friend is (ì¹œì ˆíˆ ëŒ€í•˜ëŠ” ê²ƒ).', ans:'to be kind' },
  // 9
  { context:'Minho: I want (ì¢‹ì€ ì¹œêµ¬ê°€ ë˜ê¸°ë¥¼) too.', ans:'to be a good friend' }
];

/* ===== ì„¤ì •: ì˜¤ë‹µ í—ˆìš© íšŸìˆ˜ (ë„˜ê¸°ë©´ "ì •ë‹µ ë³´ê¸°" í™œì„±í™”) ===== */
const MAX_TRIES = 3;

const total = items.length;
const $num = document.getElementById('num');
const $tot = document.getElementById('tot');
const $bar = document.getElementById('bar');
const $dialogue = document.getElementById('dialogue');
const $ans = document.getElementById('ans');
const $check = document.getElementById('checkBtn');
const $show = document.getElementById('showBtn');
const $next = document.getElementById('nextBtn');
const $reset = document.getElementById('resetBtn');
const $msg = document.getElementById('msg');
const $reveal = document.getElementById('reveal');

$tot.textContent = total;

let idx = 0;
let tries = 0;
let unlockedByTyping = false;

function norm(s){
  return s.toLowerCase()
          .replace(/[.,?!]/g,'')  // êµ¬ë‘ì  ë¬´ì‹œ
          .replace(/\s+/g,' ')     // ë‹¤ì¤‘ ê³µë°± ì •ë¦¬
          .trim();
}

function render(){
  const it = items[idx];
  $num.textContent = idx+1;
  $dialogue.innerHTML = it.context;
  $ans.value = '';
  $ans.focus();
  tries = 0;
  unlockedByTyping = false;
  $msg.textContent = '';
  $msg.className = 'msg';
  $reveal.style.display = 'none';
  $reveal.textContent = '';
  // ë²„íŠ¼ ìƒíƒœ
  $show.disabled = true;   $show.classList.add('disabled');
  $next.disabled = true;   $next.classList.add('disabled');
  updateBar();
}

function updateBar(){
  const pct = Math.round((idx)/total*100);
  $bar.style.width = pct + '%';
}

function enableShowIfNeeded(){
  if(tries >= MAX_TRIES){
    $show.disabled = false;
    $show.classList.remove('disabled');
  }
}

function check(){
  const user = norm($ans.value);
  const right = norm(items[idx].ans);

  if(!user){
    $msg.textContent = 'ì…ë ¥ í›„ í™•ì¸ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”.';
    $msg.className = 'msg bad';
    return;
  }

  if(user === right){
    $msg.textContent = 'ì •ë‹µì…ë‹ˆë‹¤! ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ì„¸ìš”.';
    $msg.className = 'msg ok';
    unlockedByTyping = true;
    $next.disabled = false;
    $next.classList.remove('disabled');
  }else{
    tries++;
    $msg.innerHTML = `ì˜¤ë‹µì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ë³´ì„¸ìš”. <small>(${tries}/${MAX_TRIES})</small>`;
    $msg.className = 'msg bad';
    enableShowIfNeeded();
  }
}

function showAnswer(){
  if($show.disabled) return;
  const ans = items[idx].ans;
  $reveal.style.display = 'block';
  $reveal.innerHTML = `<b>ì •ë‹µ</b>: <code>${ans}</code><br>â€» ì •ë‹µì„ ê·¸ëŒ€ë¡œ íƒ€ì´í•‘í•´ì•¼ <b>ë‹¤ìŒ</b>ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆì–´ìš”.`;
  $ans.focus();
}

function next(){
  if(!unlockedByTyping){
    $msg.textContent = 'ì •ë‹µì„ ì •í™•íˆ ì…ë ¥í•´ì•¼ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•  ìˆ˜ ìˆì–´ìš”.';
    $msg.className = 'msg bad';
    return;
  }
  if(idx < total-1){
    idx++;
    render();
  }else{
    $bar.style.width = '100%';
    $dialogue.innerHTML = '<b>ğŸ‰ ìˆ˜ê³ í–ˆì–´ìš”! ëª¨ë“  ë¬¸í•­ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤.</b>';
    $ans.disabled = true;
    $check.disabled = true; $check.classList.add('disabled');
    $show.disabled = true;  $show.classList.add('disabled');
    $next.disabled = true;  $next.classList.add('disabled');
    $msg.textContent = 'Congratulations! You did a great job.';
    $msg.className = 'msg ok';
  }
}

function resetAll(){
  idx = 0; tries = 0; unlockedByTyping = false;
  $ans.disabled = false; $check.disabled = false; $check.classList.remove('disabled');
  render();
}

$check.addEventListener('click', check);
$show.addEventListener('click', showAnswer);
$next.addEventListener('click', next);
$reset.addEventListener('click', resetAll);
$ans.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter'){ e.preventDefault(); check(); }
});

render();
</script>
</body>
</html>
